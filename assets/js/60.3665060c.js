(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{740:function(s,n,a){"use strict";a.r(n);var e=a(15),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"你知道-前端工程部署有哪些方式嘛"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#你知道-前端工程部署有哪些方式嘛"}},[s._v("#")]),s._v(" 你知道，前端工程部署有哪些方式嘛？")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/AttemptWeb/Record/issues/37",target:"_blank",rel:"noopener noreferrer"}},[s._v("本文原文地址"),a("OutboundLink")],1),s._v(";")]),s._v(" "),a("p",[a("strong",[s._v("此文章是回答知乎问题总结而来")]),s._v("。")]),s._v(" "),a("p",[s._v("我将其分为四个阶段："),a("strong",[s._v("手动部署")]),s._v("、"),a("strong",[s._v("命令工具部署")]),s._v("、"),a("strong",[s._v("docker镜像部署")]),s._v("、"),a("strong",[s._v("平台化部署")]),s._v("。\n这几个阶段，越往后越复杂，越往后越友好，毕竟平台化部署有备份还可回退，那是相当安全的。")]),s._v(" "),a("h2",{attrs:{id:"手动部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署"}},[s._v("#")]),s._v(" 手动部署")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 打包文件，生产dist目标文件 \nnpm run build\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("将dist下的文件使用 "),a("strong",[s._v("_FTP文件传输工具 _")]),s._v("，上传到服务器上去，就可以直接访问最新文件了。")]),s._v(" "),a("p",[a("strong",[s._v("前提")]),s._v("：服务器上已有web服务器，类似nginx服务、Apache服务，"),a("strong",[s._v("服务代理已经启动")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"流程-本地build构建打包-ftp文件上传-通过域名访问最新文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程-本地build构建打包-ftp文件上传-通过域名访问最新文件"}},[s._v("#")]),s._v(" 流程：本地build构建打包 ——> FTP文件上传 ——> 通过域名访问最新文件")]),s._v(" "),a("h2",{attrs:{id:"命令工具部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令工具部署"}},[s._v("#")]),s._v(" 命令工具部署")]),s._v(" "),a("p",[s._v("命令工具部署其实和 手动部署是一样，只是简化而已。")]),s._v(" "),a("p",[s._v("命令工具部署就是将本地build构建 和 FTP文件上传，直接通过程序来实现。例如我们通过gitlab的CI/CD工具 或 github action上传前端文件。")]),s._v(" "),a("p",[s._v("gitlab CI/CD或github action通过监听master分支push操作，进行运行你的配置命令，下面我以github action配置作为例子：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// .github/workflows/main.yml\n# name: deploy to aliyun\n# on:\n#   push:\n#     branches:\n#       - master\n# jobs:\n#   build:\n#     runs-on: ubuntu-latest\n#     steps:\n#       # 切换分支\n#       - name: Checkout\n#         uses: actions/checkout@master\n#       - name: work around permission issue\n#         run: git config --global --add safe.directory /github/workspace\n#       # 使用 node:10\n#       - name: use Node.js 10\n#         uses: actions/setup-node@v1\n#         with:\n#           node-version: 10\n#       # npm install 同时 build 打包\n#       - name: npm install and build\n#         run: |\n#           npm install\n#           npm run build\n#         env:\n#           CI: true\n#       # Deploy 上传到阿里云, secrets.ACCESS_TOKEN为配置token\n#       - name: Deploy aliyun\n#         uses: easingthemes/ssh-deploy@v2.0.7\n#         env:\n#           SSH_PRIVATE_KEY: ${{ secrets.ACCESS_TOKEN }}\n#           ARGS: "-avz --delete"\n#           SOURCE: "./docs/.vuepress/dist/"\n#           REMOTE_HOST: "47.111.149.160"\n#           REMOTE_USER: "root"\n#           TARGET: "/var/www/HerryLo.github.io"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("p",[s._v("具体细节可以参考下面的文章↓")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/97782842",target:"_blank",rel:"noopener noreferrer"}},[s._v("真香！GitHub Action一键部署"),a("OutboundLink")],1),s._v(";")]),s._v(" "),a("p",[a("strong",[s._v("前提")]),s._v("：服务器上已有web服务器，类似nginx服务、Apache服务，"),a("strong",[s._v("服务代理已经启动")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"流程-git-push代码到代码仓库-gitlab-ci-cd或github-action-依赖配置文件打包并构建上传-通过域名访问最新文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程-git-push代码到代码仓库-gitlab-ci-cd或github-action-依赖配置文件打包并构建上传-通过域名访问最新文件"}},[s._v("#")]),s._v(" 流程：git push代码到代码仓库 ——> gitlab CI/CD或github action 依赖配置文件打包并构建上传 ——> 通过域名访问最新文件")]),s._v(" "),a("h2",{attrs:{id:"docker镜像部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像部署"}},[s._v("#")]),s._v(" Docker镜像部署")]),s._v(" "),a("p",[s._v("docker部署是平台化部署的基础，算是命令工具部署，如果说便捷程度，其实**命令工具部署 和 docker部署 **差不多，但是它有个好处：docker镜像可备份；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 打包文件，生产dist目标文件 \nnpm run build\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("打包构建之后，就可以通过docker构架镜像啦，下面是docker镜像的Dockerfile文件和配置：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("FROM node:latest\nCOPY package.json /\nRUN npm i --registry=https://registry.npm.taobao.org\nRUN npm run build\n\nFROM nginx:latest\n# 这里的dist/目录是你的项目打包后的文件目录\nCOPY ./dist/ /usr/share/nginx/html/\nCOPY ./nginx.conf /etc/nginx/conf.d/\n\nEXPOSE 80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("nginx配置文件:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n    listen 80 default_server;\n    server_name _;\n\n    location / {\n      root   /usr/share/nginx/html/web;\n      index  index.html index.htm;\n      try_files $uri $uri/ /index.html;\n    }\n\n    # 接口代理示例\n    # location /api {\n    #     proxy_pass http://xxx.com;\n    #     proxy_set_header Host $host:$server_port;\n    #     proxy_set_header X-Real-IP $remote_addr;\n        #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    #     proxy_set_header Cookie $http_cookie;\n    #     proxy_buffering off;\n    #     proxy_cache off;\n    # }\n  }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("之后 通过 docker build 、docker push 镜像名 将镜像打包并推到远端仓库（一般是自己公司项目的私库），然后在服务器上拉取更新最新的镜像，然后将最新的镜像启动即可。")]),s._v(" "),a("p",[a("strong",[s._v("提示")]),s._v("：docker 镜像一般会直接把nginx服务打包在一起，所以不用再在服务器上开启单独的服务，只需要将docker端口开放即可。当然，如果是为了统一管理端口，也是可以通过专门的代理服务管理。")]),s._v(" "),a("h3",{attrs:{id:"流程-本地-build打包文件-docker打包镜像-服务器更新镜像并开启最新镜像-通过域名访问最新文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程-本地-build打包文件-docker打包镜像-服务器更新镜像并开启最新镜像-通过域名访问最新文件"}},[s._v("#")]),s._v(" "),a("strong",[s._v("流程：本地 build")]),s._v("打包文件** ——> **docker打包镜像_ ——> 服务器更新镜像并开启最新镜像 ——> 通过域名访问最新文件_")]),s._v(" "),a("p",[s._v("具体细节可以参考下面的文章↓")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/597004812",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker构建前端项目"),a("OutboundLink")],1),s._v(";")]),s._v(" "),a("h2",{attrs:{id:"平台化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#平台化部署"}},[s._v("#")]),s._v(" 平台化部署")]),s._v(" "),a("p",[s._v("平台化部署其实就是全流程： **命令工具部署 **+ "),a("strong",[s._v("docker镜像的组合版。")])]),s._v(" "),a("p",[s._v("只需要将代码push提交，之后通过网页访问构建打包平台，例如：阿里云效流水线 或 jekins打包构建 等平台，可以通过点击按钮，下一步下一步的方式，完成打包构建，镜像上传。")]),s._v(" "),a("p",[s._v("至于更新，我是使用rancher平台来进行，服务的管理或更新，镜像上传完之后，可以在rancher平台配置好相关的负载服务，剩下就只是点击更新按钮就可以。")]),s._v(" "),a("p",[s._v("下面是以 阿里codeup流水线 + rancher作为流程示例：")]),s._v(" "),a("p",[a("strong",[s._v("提示")]),s._v("：_阿里codeup流水线 或 jekins打包构建 就类似于docker镜像打包，rancher部署就类似于我们将最新镜像上传到服务器上，然后开启服务。（"),a("strong",[s._v("rancher部署可能更加复杂，因为还涉及到k8s集群知识")]),s._v("）")]),s._v(" "),a("h3",{attrs:{id:"流程-git-push代码到代码仓库-通过-codeup-流水线构建打包上传镜像-rancher等平台更新镜像-通过域名访问最新文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程-git-push代码到代码仓库-通过-codeup-流水线构建打包上传镜像-rancher等平台更新镜像-通过域名访问最新文件"}},[s._v("#")]),s._v(" 流程：git push代码到代码仓库 ——> 通过_codeup_流水线构建打包上传镜像 ——> rancher等平台更新镜像 ——> 通过域名访问最新文件")]),s._v(" "),a("p",[s._v("具体细节可以参考下面的文章↓")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/516678628",target:"_blank",rel:"noopener noreferrer"}},[s._v("知识扩展-Rancher前端服务发布"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("前端应用部署变化到现在的阶段，也是项目众多不便于管理导致，实际的业务情况，进而推动部署方式的发展。\n前端部署的流程每个公司都有一套自己的流程，学习它，适应它，就好了，没有太多疑难问题。")]),s._v(" "),a("p",[s._v("使用工具没有什么难度，难度可能就是你用的不太熟。")]),s._v(" "),a("h3",{attrs:{id:"你的点赞、收藏是我的更新的动力"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#你的点赞、收藏是我的更新的动力"}},[s._v("#")]),s._v(" 你的点赞、收藏是我的更新的动力！！")])])}),[],!1,null,null,null);n.default=t.exports}}]);